(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[445],{7926:function(e,t,s){Promise.resolve().then(s.bind(s,6973))},6973:function(e,t,s){"use strict";s.r(t);var n=s(7437),i=s(2265);t.default=function(){let[e,t]=(0,i.useState)([]),[s,a]=(0,i.useState)(null),[l,c]=(0,i.useState)({}),[o,d]=(0,i.useState)([]),[r,u]=(0,i.useState)(null),m=async()=>{let e=await fetch("".concat("https://voting-app-ui85.onrender.com","/api/votes")),s=await e.json();t(s),r&&d(s.filter(e=>e.votedBy.includes(r)).map(e=>e._id))};(0,i.useEffect)(()=>{let e=localStorage.getItem("token");if(!e){window.location.href="/Voting-App/login";return}fetch("".concat("https://voting-app-ui85.onrender.com","/api/users/me"),{headers:{Authorization:"Bearer ".concat(e)}}).then(e=>e.json()).then(e=>u(e._id)),m()},[r]);let h=(t,s)=>{c(n=>{if("single"===e.find(e=>e._id===t).type)return{...n,[t]:s};{let e=n[t]||[];return e.includes(s)?{...n,[t]:e.filter(e=>e!==s)}:{...n,[t]:[...e,s]}}})},p=async t=>{let s=localStorage.getItem("token"),n="single"===e.find(e=>e._id===t).type?l[t]:l[t]||[];(await fetch("".concat("https://voting-app-ui85.onrender.com","/api/vote/").concat(t),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify({vote:n})})).ok&&(d(e=>[...e,t]),m())};return(0,n.jsx)("div",{className:"flex justify-center items-center min-h-screen bg-gradient-to-r from-[#e0f7fa] to-[#80deea] p-6",children:(0,n.jsxs)("div",{className:"w-full max-w-3xl",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold mb-6 text-center text-black",children:"Voting Page"}),e.map(e=>(0,n.jsxs)("div",{className:"border border-gray-300 p-6 rounded-lg mb-6 bg-white shadow-lg",children:[(0,n.jsx)("h3",{className:"text-xl font-semibold mb-4 text-black",children:e.question}),(0,n.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"single"===e.type?"Single Choice":"Multiple Choice"}),(0,n.jsx)("div",{className:"mb-4",children:e.answers.map((t,s)=>(0,n.jsxs)("label",{className:"block mb-2 text-black",children:[(0,n.jsx)("input",{type:"single"===e.type?"radio":"checkbox",name:"vote-".concat(e._id),value:t.text,onChange:()=>h(e._id,t.text),disabled:o.includes(e._id),className:"mr-2"}),t.text]},s))}),(0,n.jsx)("button",{onClick:()=>p(e._id),className:"w-full p-2 rounded mt-4 ".concat(o.includes(e._id)?"bg-gray-500":"bg-[#800000] text-white"),disabled:o.includes(e._id),children:o.includes(e._id)?"Submitted":"Submit Vote"})]},e._id)),s&&(0,n.jsxs)("div",{className:"mt-6 p-6 bg-white rounded-lg shadow-lg",children:[(0,n.jsxs)("h3",{className:"text-xl font-semibold mb-4 text-black",children:["Results for: ",s.question]}),(0,n.jsxs)("p",{className:"text-black",children:["Yes: ",s.yesVotes]}),(0,n.jsxs)("p",{className:"text-black",children:["No: ",s.noVotes]})]})]})})}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=7926)}),_N_E=e.O()}]);